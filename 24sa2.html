<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lorca Underground - Selector de Niveles</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nosifer&family=Roboto+Mono:wght@400;700&display=swap');
        
        body {
            background-color: #050505;
            color: #d1d1d1;
            font-family: 'Roboto Mono', monospace;
        }

        .crime-title {
            font-family: 'Nosifer', cursive;
            color: #ff0000;
            text-shadow: 3px 3px 6px #000;
        }

        .glass-panel {
            background: rgba(20, 20, 20, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid #444;
        }

        .btn-option {
            background: #1a1a1a;
            border: 1px solid #333;
            transition: all 0.2s ease;
            width: 100%;
            text-align: left;
            padding: 1rem;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .btn-option:hover:not(:disabled) {
            border-color: #ff0000;
            background: #2a0000;
            transform: translateX(5px);
        }

        .btn-option:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .level-card {
            background: #111;
            border: 2px solid #333;
            padding: 1.5rem;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .level-card:hover {
            border-color: #ff0000;
            transform: translateY(-5px);
            background: #1a0505;
        }

        #game-container {
            max-width: 800px;
            margin: 1.5rem auto;
            padding: 2rem;
            border-radius: 12px;
        }

        input[type="text"] {
            background: #111;
            border: 1px solid #ff0000;
            color: white;
            padding: 10px;
            border-radius: 4px;
            outline: none;
            text-align: center;
        }

        .modal-overlay {
            background: rgba(0,0,0,0.9);
        }
    </style>
</head>
<body class="p-4">

    <div id="game-container" class="glass-panel shadow-2xl">
        <h1 class="crime-title text-2xl md:text-4xl text-center mb-6">LORCA UNDERGROUND</h1>
        
        <div id="stats-header" class="hidden flex justify-between items-center text-xs md:text-sm mb-4 border-b border-zinc-800 pb-2">
            <div>ALIAS: <span id="nombre-display" class="text-red-500 font-bold"></span></div>
            <div>VIDAS: <span id="vidas" class="text-white font-bold bg-red-700 px-2 rounded">3</span></div>
            <button onclick="irASeleccionNivel()" class="text-zinc-500 hover:text-white underline text-xs">ABANDONAR MISI√ìN</button>
        </div>

        <!-- Pantalla 1: Registro -->
        <div id="pantalla-inicio" class="text-center">
            <p class="mb-6 text-gray-400">Introduce tu nombre en el registro criminal de la Ciudad del Sol.</p>
            <div class="flex flex-col gap-4 items-center mb-8">
                <input type="text" id="nombre-input" placeholder="Tu alias criminal..." maxlength="20">
            </div>
            <button onclick="registrarYContinuar()" class="bg-red-700 hover:bg-red-600 text-white px-10 py-4 rounded uppercase font-bold">Registrar Alias</button>
        </div>

        <!-- Pantalla 2: Selector de Niveles -->
        <div id="pantalla-seleccion" class="hidden">
            <h2 class="text-xl font-bold text-center mb-8 text-white">ELIGE TU PR√ìXIMO GOLPE</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="level-card text-center" onclick="iniciarNivel(1)">
                    <span class="text-4xl">üö¨</span>
                    <h3 class="text-yellow-500 font-bold mt-2">NIVEL 1</h3>
                    <p class="text-xs text-gray-500 mt-2">Hurtos y Escapes Sencillos (MRU B√°sico)</p>
                </div>
                <div class="level-card text-center" onclick="iniciarNivel(2)">
                    <span class="text-4xl">üöî</span>
                    <h3 class="text-orange-500 font-bold mt-2">NIVEL 2</h3>
                    <p class="text-xs text-gray-500 mt-2">Persecuciones y Encuentros (Velocidad Relativa)</p>
                </div>
                <div class="level-card text-center" onclick="iniciarNivel(3)">
                    <span class="text-4xl">üöÅ</span>
                    <h3 class="text-red-600 font-bold mt-2">NIVEL 3</h3>
                    <p class="text-xs text-gray-500 mt-2">Estado de Sitio y Legi√≥n (Conversiones y Retos)</p>
                </div>
            </div>
        </div>

        <!-- Pantalla 3: Juego -->
        <div id="pantalla-juego" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <span id="label-fuerza" class="bg-white text-black px-2 py-1 text-xs font-bold rounded uppercase"></span>
                <span id="label-num-mision" class="text-zinc-500 text-xs">Misi√≥n 1 de 5</span>
            </div>
            
            <div id="escenario-img" class="w-full h-32 bg-zinc-900 rounded mb-4 flex items-center justify-center border border-zinc-800 relative">
                <span id="emoji-escenario" class="text-6xl">üèôÔ∏è</span>
            </div>

            <p id="enunciado" class="text-sm md:text-base mb-6 leading-relaxed text-yellow-100"></p>
            
            <div id="opciones" class="flex flex-col gap-3"></div>

            <div id="area-navegacion" class="mt-6 hidden">
                <p id="feedback" class="p-4 rounded text-sm font-bold mb-4"></p>
                <button id="btn-siguiente" onclick="siguienteProblema()" class="w-full bg-blue-700 hover:bg-blue-600 text-white py-3 rounded font-bold uppercase">Siguiente Paso</button>
            </div>
        </div>

        <!-- Pantalla Final -->
        <div id="pantalla-final" class="hidden text-center">
            <h2 id="resultado-titulo" class="text-4xl font-bold mb-6"></h2>
            <p id="resultado-desc" class="mb-10 text-lg text-gray-300"></p>
            <button onclick="irASeleccionNivel()" class="bg-white text-black px-10 py-4 rounded uppercase font-bold hover:bg-gray-200">Volver al mapa de Lorca</button>
        </div>
    </div>

    <!-- Modal de Consecuencias -->
    <div id="modal-consecuencia" class="hidden fixed inset-0 modal-overlay flex items-center justify-center z-50 p-4">
        <div class="bg-red-950 border-2 border-red-500 p-8 rounded-lg shadow-2xl max-w-md text-center">
            <h4 class="text-red-500 font-black text-2xl mb-4 italic">INFORME DE DA√ëOS</h4>
            <p id="msg-consecuencia" class="text-red-100 font-bold mb-6"></p>
            <button onclick="cerrarModal()" class="bg-white text-black px-6 py-2 rounded font-black uppercase">Entendido</button>
        </div>
    </div>

    <script>
        let vidas = 3;
        let nombreCriminal = "";
        let nivelSeleccionado = 0;
        let indiceMisionLocal = 0;
        let misionesActivas = [];

        const consecuenciasMsg = [
            "¬°OPERACI√ìN COMPROMETIDA! {nombre}, la polic√≠a ha reventado una de tus naves. Pierdes 20.000‚Ç¨.",
            "¬°TRAICI√ìN! Uno de tus informadores ha hablado. {nombre} pierde suministros clave.",
            "¬°CERCO POLICIAL! Han confiscado tu coche favorito. {nombre} se queda sin transporte de huida."
        ];

        const baseMisiones = [
            // NIVEL 1
            { nivel: 1, fuerza: "Polic√≠a Local", enunciado: "Escapas de la Plaza del Negrito. Recorres 400m en 80s. ¬øVelocidad?", opciones: [{t:"5 m/s",c:true},{t:"4 m/s",c:false},{t:"6 m/s",c:false}], e:"üèôÔ∏è" },
            { nivel: 1, fuerza: "Polic√≠a Local", enunciado: "Coche de huida a 15 m/s. Necesitas llegar a 450m. ¬øTiempo?", opciones: [{t:"30s",c:true},{t:"20s",c:false},{t:"40s",c:false}], e:"üöó" },
            { nivel: 1, fuerza: "Polic√≠a Local", enunciado: "Huyes a 6 m/s durante 1 minuto (60s). ¬øDistancia?", opciones: [{t:"360m",c:true},{t:"300m",c:false},{t:"400m",c:false}], e:"üèÉ" },
            { nivel: 1, fuerza: "Polic√≠a Local", enunciado: "Patrulla a 200m viene a 5 m/s. ¬øCu√°nto tiempo tienes?", opciones: [{t:"40s",c:true},{t:"50s",c:false},{t:"30s",c:false}], e:"üöì" },
            { nivel: 1, fuerza: "Polic√≠a Local", enunciado: "Cruzas un callej√≥n de 90m a 3 m/s. ¬øTiempo?", opciones: [{t:"30s",c:true},{t:"20s",c:false},{t:"40s",c:false}], e:"üß±" },

            // NIVEL 2
            { nivel: 2, fuerza: "Guardia Civil", enunciado: "Vas a 25 m/s. Patrulla a 300m detr√°s a 30 m/s. ¬øTiempo de alcance?", opciones: [{t:"60s",c:true},{t:"50s",c:false},{t:"40s",c:false}], e:"üõ£Ô∏è" },
            { nivel: 2, fuerza: "Guardia Civil", enunciado: "Dos motos de tu banda a 4 km se buscan a 20m/s y 30m/s. ¬øEncuentro?", opciones: [{t:"80s",c:true},{t:"100s",c:false},{t:"70s",c:false}], e:"üèçÔ∏è" },
            { nivel: 2, fuerza: "Guardia Civil", enunciado: "Un dron recorre 1.5km en 50s. ¬øVelocidad m/s?", opciones: [{t:"30 m/s",c:true},{t:"25 m/s",c:false},{t:"40 m/s",c:false}], e:"üõ∏" },
            { nivel: 2, fuerza: "Guardia Civil", enunciado: "Cami√≥n a 18 m/s recorre 5.4 km. ¬øTiempo en minutos?", opciones: [{t:"5 min",c:true},{t:"4 min",c:false},{t:"6 min",c:false}], e:"üöõ" },
            { nivel: 2, fuerza: "Guardia Civil", enunciado: "Lancha a 12 m/s contra patrullera a 15 m/s (distancia 600m). ¬øTiempo?", opciones: [{t:"200s",c:true},{t:"150s",c:false},{t:"250s",c:false}], e:"üö§" },

            // NIVEL 3
            { nivel: 3, fuerza: "Ej√©rcito", enunciado: "Blindado a 90 km/h (25 m/s). Est√° a 5km. ¬øTiempo de llegada?", opciones: [{t:"200s",c:true},{t:"150s",c:false},{t:"250s",c:false}], e:"üéñÔ∏è" },
            { nivel: 3, fuerza: "Legi√≥n", enunciado: "Helic√≥ptero a 180km/h (50m/s) tras de ti a 1km. Vas a 144km/h (40m/s). ¬øTiempo?", opciones: [{t:"100s",c:true},{t:"80s",c:false},{t:"120s",c:false}], e:"üöÅ" },
            { nivel: 3, fuerza: "Ej√©rcito", enunciado: "Recorrer 3.6km en 10 min. ¬øVelocidad m√≠nima m/s?", opciones: [{t:"6 m/s",c:true},{t:"5 m/s",c:false},{t:"7 m/s",c:false}], e:"üèÉ" },
            { nivel: 3, fuerza: "Legi√≥n", enunciado: "Convoy (15m/s) y t√∫ (35m/s) a 10km. ¬øTiempo de cruce?", opciones: [{t:"200s",c:true},{t:"250s",c:false},{t:"150s",c:false}], e:"‚öîÔ∏è" },
            { nivel: 3, fuerza: "Ej√©rcito", enunciado: "Puente de 1.2km a 20m/s. Bomba en 1 minuto exacto. ¬øSales?", opciones: [{t:"S√≠, justo",c:true},{t:"No, faltan 5s",c:false},{t:"S√≠, sobran 10s",c:false}], e:"üí•" }
        ];

        function registrarYContinuar() {
            const input = document.getElementById('nombre-input').value.trim();
            if (input === "") return alert("Identif√≠cate, criminal.");
            nombreCriminal = input;
            document.getElementById('nombre-display').innerText = nombreCriminal;
            document.getElementById('pantalla-inicio').classList.add('hidden');
            document.getElementById('pantalla-seleccion').classList.remove('hidden');
        }

        function irASeleccionNivel() {
            document.getElementById('pantalla-juego').classList.add('hidden');
            document.getElementById('pantalla-final').classList.add('hidden');
            document.getElementById('stats-header').classList.add('hidden');
            document.getElementById('pantalla-seleccion').classList.remove('hidden');
        }

        function iniciarNivel(n) {
            nivelSeleccionado = n;
            vidas = 3;
            indiceMisionLocal = 0;
            misionesActivas = baseMisiones.filter(m => m.nivel === n);
            
            document.getElementById('vidas').innerText = vidas;
            document.getElementById('pantalla-seleccion').classList.add('hidden');
            document.getElementById('stats-header').classList.remove('hidden');
            document.getElementById('pantalla-juego').classList.remove('hidden');
            
            renderMision();
        }

        function renderMision() {
            const m = misionesActivas[indiceMisionLocal];
            document.getElementById('label-fuerza').innerText = m.fuerza;
            document.getElementById('label-num-mision').innerText = `Misi√≥n ${indiceMisionLocal + 1} de 5`;
            document.getElementById('enunciado').innerText = m.enunciado;
            document.getElementById('emoji-escenario').innerText = m.e;
            document.getElementById('area-navegacion').classList.add('hidden');
            
            const opts = document.getElementById('opciones');
            opts.innerHTML = '';
            m.opciones.forEach(o => {
                const b = document.createElement('button');
                b.className = "btn-option";
                b.innerText = o.t;
                b.onclick = () => validar(o.c);
                opts.appendChild(b);
            });
        }

        function validar(esCorrecta) {
            const fb = document.getElementById('feedback');
            const btns = document.querySelectorAll('.btn-option');
            btns.forEach(b => b.disabled = true);

            if (esCorrecta) {
                fb.innerText = "¬°IMPECABLE! Operaci√≥n exitosa.";
                fb.className = "p-4 rounded text-sm bg-green-900 text-green-200 border border-green-500 font-bold mb-4";
            } else {
                vidas--;
                document.getElementById('vidas').innerText = vidas;
                fb.innerText = "¬°ERROR! Las consecuencias son graves.";
                fb.className = "p-4 rounded text-sm bg-red-900 text-red-200 border border-red-500 font-bold mb-4";
                
                const msg = consecuenciasMsg[2 - vidas].replace("{nombre}", nombreCriminal);
                document.getElementById('msg-consecuencia').innerText = msg;
                document.getElementById('modal-consecuencia').classList.remove('hidden');

                if (vidas <= 0) {
                    setTimeout(() => terminar(false), 500);
                    return;
                }
            }
            document.getElementById('area-navegacion').classList.remove('hidden');
        }

        function cerrarModal() {
            document.getElementById('modal-consecuencia').classList.add('hidden');
        }

        function siguienteProblema() {
            indiceMisionLocal++;
            if (indiceMisionLocal >= misionesActivas.length) {
                terminar(true);
            } else {
                renderMision();
            }
        }

        function terminar(ganaste) {
            document.getElementById('pantalla-juego').classList.add('hidden');
            const fin = document.getElementById('pantalla-final');
            fin.classList.remove('hidden');
            
            const tit = document.getElementById('resultado-titulo');
            const desc = document.getElementById('resultado-desc');

            if (ganaste) {
                tit.innerText = "MISI√ìN CUMPLIDA";
                tit.className = "text-4xl font-bold mb-6 text-green-500";
                desc.innerText = `${nombreCriminal}, has dominado el Nivel ${nivelSeleccionado} en Lorca. Tus c√°lculos han sido perfectos.`;
            } else {
                tit.innerText = "CA√çDO EN ACCI√ìN";
                tit.className = "text-4xl font-bold mb-6 text-red-600";
                desc.innerText = `${nombreCriminal} ha sido interceptado. Se acab√≥ tu carrera en este nivel.`;
            }
        }
    </script>
</body>
</html>
